#include "SG256.h"

int main()
{
    // uint8_t data[32] = {
    //     0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41,
    //     0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41,
    //     0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41,
    //     0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41,
    // };

    // uint8_t key[32] = {
    //     0xa0, 0x07, 0x29, 0xd2, 0xa6, 0x76, 0x92, 0x46,
    //     0xd1, 0x68, 0x37, 0x87, 0x22, 0xb3, 0x6a, 0x82,
    //     0x6c, 0x72, 0xb9, 0xa3, 0xc1, 0x09, 0x75, 0x57,
    //     0xbd, 0xe6, 0xe5, 0x85, 0xd6, 0x16, 0x0a, 0x34
    // };

    uint8_t *k = (uint8_t *)malloc(BLOCK_SIZE + 1);
    k[BLOCK_SIZE] = 0x00;
    memset(k, 0x61, 32);

    const char *file_name = "KEY_HEX.txt";
    FILE *f_ptr = fopen(file_name, "wb");
    char temp[3] = {0};
    for(uint32_t x = 0, n = 4096000; x < n; ++x) {
        for(uint8_t y = 0; y < BLOCK_SIZE; ++y) {
            sprintf(temp, "%02x", k[y]);
            fputs(temp, f_ptr);
        }
        fputc('\n', f_ptr);
        k = rounds_key_update(k);
    }
    
    fclose(f_ptr);

    return 0;
}

